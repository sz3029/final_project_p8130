---
title: "Model-selection-backwork"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(tidyverse)
library(corrplot)
library(leaps)

```

## Exploratory Analysis

```{r}
# read data 
crime_df = 
  read_csv("cdi.csv") %>% 
  mutate(
    region = factor(region),
    pop_density = pop / area,
    crm_1000 = 1000 * crimes / pop
  ) %>% 
  dplyr::select(-crimes, -id, -area, -pop, -cty, -state) %>% 
  dplyr::select(crm_1000, everything())

# fit regression using all predictors
mult.fit = lm(crm_1000 ~ ., data = crime_df)

step(mult.fit, direction = 'backward')

step(mult.fit, direction = 'forward')

step(mult.fit, direction = 'both')


```

## Test Based Procedures

```{r}
mat = as.matrix(crime_df)
# Printing the 2 best models of each size, using the Cp criterion:
leaps(x = mat[,2:13], y = mat[,1], nbest = 2, method = "Cp")

# Printing the 2 best models of each size, using the adjusted R^2 criterion:
leaps(x = mat[,2:13], y = mat[,1], nbest = 2, method = "adjr2")

# Function regsubsets() performs a subset selection by identifying the "best" model that contains
# a certain number of predictors. By default "best" is chosen using SSE/RSS (smaller is better)
b = regsubsets(crm_1000 ~ ., data = crime_df)
rs = summary(b)

# plot of Cp and Adj-R2 as functions of parameters
par(mfrow=c(1,2))

plot(1:8, rs$cp, xlab="No of parameters", ylab="Cp Statistic")
abline(0,1)
#6
plot(1:8, rs$adjr2, xlab="No of parameters", ylab="Adj R2")
#6
```

  
  